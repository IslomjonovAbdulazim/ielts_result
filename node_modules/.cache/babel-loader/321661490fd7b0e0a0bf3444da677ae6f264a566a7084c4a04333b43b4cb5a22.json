{"ast":null,"code":"import { logger } from './logger';\nimport { Utils } from '../utils/helpers';\n\n// API service for IELTS Results app\nclass ApiService {\n  constructor() {\n    // Use proxy in development, full URL in production\n    this.baseURL = process.env.NODE_ENV === 'development' ? '' // Use proxy\n    : 'https://ieltsspeakingbot-production.up.railway.app';\n    this.defaultTimeout = 15000; // 15 seconds\n    this.retryAttempts = 3;\n    this.retryDelay = 1000; // 1 second\n\n    logger.info('API', 'ApiService initialized', {\n      baseURL: this.baseURL || 'Using proxy',\n      environment: process.env.NODE_ENV\n    });\n  }\n\n  // Main method to fetch session data\n  async fetchSessionData(sessionCode) {\n    logger.info('API', 'Fetching session data', {\n      sessionCode\n    });\n    if (!sessionCode) {\n      const error = new Error('Session code is required');\n      logger.error('API', 'No session code provided');\n      throw error;\n    }\n    if (!Utils.isValidSessionCode(sessionCode)) {\n      const error = new Error('Invalid session code format');\n      logger.error('API', 'Invalid session code format', {\n        sessionCode\n      });\n      throw error;\n    }\n    const timer = logger.startTimer('fetchSessionData');\n    try {\n      var _response$conversatio, _response$conversatio2;\n      const url = `${this.baseURL}/session/${sessionCode}`;\n      logger.info('API', 'Making API request', {\n        url,\n        fullURL: url,\n        baseURL: this.baseURL,\n        sessionCode,\n        environment: process.env.NODE_ENV\n      });\n      const response = await Utils.retry(() => this.makeRequest(url), this.retryAttempts, this.retryDelay);\n      timer.stop();\n\n      // Validate response structure\n      this.validateSessionData(response);\n      logger.info('API', 'Session data fetched successfully', {\n        sessionCode,\n        hasConversations: ((_response$conversatio = response.conversations) === null || _response$conversatio === void 0 ? void 0 : _response$conversatio.length) > 0,\n        totalConversations: ((_response$conversatio2 = response.conversations) === null || _response$conversatio2 === void 0 ? void 0 : _response$conversatio2.length) || 0\n      });\n      return response;\n    } catch (error) {\n      timer.stop();\n\n      // Enhanced error handling\n      const enhancedError = this.handleApiError(error, sessionCode);\n      logger.error('API', 'Failed to fetch session data', {\n        sessionCode,\n        error: enhancedError.message,\n        status: enhancedError.status,\n        originalError: error.message\n      });\n      throw enhancedError;\n    }\n  }\n\n  // Low-level request method\n  async makeRequest(url, options = {}) {\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), this.defaultTimeout);\n    const defaultOptions = {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      signal: controller.signal\n    };\n    const requestOptions = {\n      ...defaultOptions,\n      ...options\n    };\n    const startTime = performance.now();\n    try {\n      logger.debug('API', 'Making HTTP request', {\n        url,\n        method: requestOptions.method\n      });\n      const response = await fetch(url, requestOptions);\n      const endTime = performance.now();\n      const duration = endTime - startTime;\n      clearTimeout(timeoutId);\n      logger.logApiCall(requestOptions.method, url, response.status, duration, requestOptions.body, null // Response data will be logged separately\n      );\n      if (!response.ok) {\n        const errorText = await response.text().catch(() => 'Unable to read error response');\n        const error = new Error(`HTTP ${response.status}: ${response.statusText}`);\n        error.status = response.status;\n        error.response = response;\n        error.responseText = errorText;\n        throw error;\n      }\n      const contentType = response.headers.get('content-type');\n      if (!contentType || !contentType.includes('application/json')) {\n        logger.warn('API', 'Response is not JSON', {\n          contentType,\n          url\n        });\n      }\n      const data = await response.json();\n      logger.debug('API', 'Request successful', {\n        url,\n        status: response.status,\n        duration: `${duration.toFixed(2)}ms`,\n        dataSize: JSON.stringify(data).length + ' bytes'\n      });\n      return data;\n    } catch (error) {\n      clearTimeout(timeoutId);\n      const endTime = performance.now();\n      const duration = endTime - startTime;\n      if (error.name === 'AbortError') {\n        logger.error('API', 'Request timeout', {\n          url,\n          timeout: this.defaultTimeout\n        });\n        const timeoutError = new Error('Request timeout');\n        timeoutError.code = 'TIMEOUT';\n        throw timeoutError;\n      }\n      logger.logApiCall(requestOptions.method, url, error.status || 0, duration, requestOptions.body, error.message);\n      throw error;\n    }\n  }\n\n  // Validate session data structure\n  validateSessionData(data) {\n    logger.debug('API', 'Validating session data structure');\n    if (!data || typeof data !== 'object') {\n      throw new Error('Invalid response: data is not an object');\n    }\n\n    // Required fields validation\n    const requiredFields = ['session_info', 'user_info', 'conversations'];\n    for (const field of requiredFields) {\n      if (!data[field]) {\n        logger.warn('API', `Missing required field: ${field}`);\n      }\n    }\n\n    // Validate session_info\n    if (data.session_info) {\n      const sessionRequiredFields = ['id', 'status'];\n      for (const field of sessionRequiredFields) {\n        if (!data.session_info[field]) {\n          logger.warn('API', `Missing session_info field: ${field}`);\n        }\n      }\n    }\n\n    // Validate conversations array\n    if (data.conversations && Array.isArray(data.conversations)) {\n      logger.info('API', 'Validating conversations', {\n        count: data.conversations.length\n      });\n      data.conversations.forEach((conv, index) => {\n        if (!conv.question_text) {\n          logger.warn('API', `Missing question_text in conversation ${index}`);\n        }\n        if (!conv.transcript) {\n          logger.warn('API', `Missing transcript in conversation ${index}`);\n        }\n        if (!conv.ielts_scores) {\n          logger.warn('API', `Missing ielts_scores in conversation ${index}`);\n        }\n      });\n    }\n    logger.info('API', 'Session data validation completed');\n  }\n\n  // Enhanced error handling\n  handleApiError(error, sessionCode) {\n    let message = 'An error occurred while fetching the results';\n    let code = 'UNKNOWN_ERROR';\n    let status = error.status || 0;\n    if (error.name === 'AbortError' || error.code === 'TIMEOUT') {\n      message = 'Request timeout. Please check your internet connection and try again.';\n      code = 'TIMEOUT';\n    } else if (error.status === 404) {\n      message = 'Results not found for this session. Please check the session code.';\n      code = 'NOT_FOUND';\n    } else if (error.status === 400) {\n      message = 'Invalid session code format.';\n      code = 'BAD_REQUEST';\n    } else if (error.status === 403) {\n      message = 'Access denied. You may not have permission to view these results.';\n      code = 'FORBIDDEN';\n    } else if (error.status === 429) {\n      message = 'Too many requests. Please wait a moment and try again.';\n      code = 'RATE_LIMITED';\n    } else if (error.status >= 500) {\n      message = 'Server error. Please try again later.';\n      code = 'SERVER_ERROR';\n    } else if (!navigator.onLine) {\n      message = 'No internet connection. Please check your connection and try again.';\n      code = 'NO_CONNECTION';\n    } else if (error.message.includes('Failed to fetch')) {\n      message = 'Unable to connect to the server. Please try again later.';\n      code = 'NETWORK_ERROR';\n    }\n    const enhancedError = new Error(message);\n    enhancedError.code = code;\n    enhancedError.status = status;\n    enhancedError.sessionCode = sessionCode;\n    enhancedError.originalError = error;\n    return enhancedError;\n  }\n\n  // Method to get cached session data\n  getCachedSessionData(sessionCode, maxAge = 5 * 60 * 1000) {\n    // 5 minutes default\n    const cached = Utils.getStorage(`session_${sessionCode}`, 'sessionStorage');\n    if (!cached) {\n      logger.debug('API', 'No cached data found', {\n        sessionCode\n      });\n      return null;\n    }\n    const isExpired = Date.now() - cached.timestamp > maxAge;\n    if (isExpired) {\n      logger.debug('API', 'Cached data expired', {\n        sessionCode\n      });\n      Utils.removeStorage(`session_${sessionCode}`, 'sessionStorage');\n      return null;\n    }\n    logger.info('API', 'Using cached session data', {\n      sessionCode\n    });\n    return cached.data;\n  }\n\n  // Method to cache session data\n  cacheSessionData(sessionCode, data) {\n    Utils.setStorage(`session_${sessionCode}`, {\n      data,\n      timestamp: Date.now()\n    }, 'sessionStorage');\n    logger.info('API', 'Session data cached', {\n      sessionCode\n    });\n  }\n\n  // Method to clear all cached data\n  clearCache() {\n    logger.info('API', 'Clearing API cache');\n\n    // Clear all session storage items that start with 'session_'\n    for (let i = sessionStorage.length - 1; i >= 0; i--) {\n      const key = sessionStorage.key(i);\n      if (key && key.startsWith('session_')) {\n        sessionStorage.removeItem(key);\n      }\n    }\n    logger.info('API', 'API cache cleared');\n  }\n\n  // Method to check API health\n  async checkApiHealth() {\n    logger.info('API', 'Checking API health');\n    try {\n      const url = `${this.baseURL}/health`;\n      const response = await this.makeRequest(url);\n      logger.info('API', 'API health check successful', response);\n      return true;\n    } catch (error) {\n      logger.error('API', 'API health check failed', {\n        error: error.message\n      });\n      return false;\n    }\n  }\n\n  // Method to get API statistics\n  getApiStats() {\n    const stats = {\n      baseURL: this.baseURL,\n      defaultTimeout: this.defaultTimeout,\n      retryAttempts: this.retryAttempts,\n      retryDelay: this.retryDelay,\n      isOnline: navigator.onLine,\n      userAgent: navigator.userAgent\n    };\n    logger.debug('API', 'API statistics', stats);\n    return stats;\n  }\n}\n\n// Create and export API service instance\nexport const apiService = new ApiService();\nlogger.info('API', 'API service initialized successfully');","map":{"version":3,"names":["logger","Utils","ApiService","constructor","baseURL","process","env","NODE_ENV","defaultTimeout","retryAttempts","retryDelay","info","environment","fetchSessionData","sessionCode","error","Error","isValidSessionCode","timer","startTimer","_response$conversatio","_response$conversatio2","url","fullURL","response","retry","makeRequest","stop","validateSessionData","hasConversations","conversations","length","totalConversations","enhancedError","handleApiError","message","status","originalError","options","controller","AbortController","timeoutId","setTimeout","abort","defaultOptions","method","headers","signal","requestOptions","startTime","performance","now","debug","fetch","endTime","duration","clearTimeout","logApiCall","body","ok","errorText","text","catch","statusText","responseText","contentType","get","includes","warn","data","json","toFixed","dataSize","JSON","stringify","name","timeout","timeoutError","code","requiredFields","field","session_info","sessionRequiredFields","Array","isArray","count","forEach","conv","index","question_text","transcript","ielts_scores","navigator","onLine","getCachedSessionData","maxAge","cached","getStorage","isExpired","Date","timestamp","removeStorage","cacheSessionData","setStorage","clearCache","i","sessionStorage","key","startsWith","removeItem","checkApiHealth","getApiStats","stats","isOnline","userAgent","apiService"],"sources":["/Users/abdulazim/Documents/web_stuff/real-projects/ielts_result/src/services/apiService.js"],"sourcesContent":["import { logger } from './logger';\nimport { Utils } from '../utils/helpers';\n\n// API service for IELTS Results app\nclass ApiService {\n    constructor() {\n        // Use proxy in development, full URL in production\n        this.baseURL = process.env.NODE_ENV === 'development' \n            ? '' // Use proxy\n            : 'https://ieltsspeakingbot-production.up.railway.app';\n        this.defaultTimeout = 15000; // 15 seconds\n        this.retryAttempts = 3;\n        this.retryDelay = 1000; // 1 second\n        \n        logger.info('API', 'ApiService initialized', { \n            baseURL: this.baseURL || 'Using proxy',\n            environment: process.env.NODE_ENV \n        });\n    }\n\n    // Main method to fetch session data\n    async fetchSessionData(sessionCode) {\n        logger.info('API', 'Fetching session data', { sessionCode });\n        \n        if (!sessionCode) {\n            const error = new Error('Session code is required');\n            logger.error('API', 'No session code provided');\n            throw error;\n        }\n\n        if (!Utils.isValidSessionCode(sessionCode)) {\n            const error = new Error('Invalid session code format');\n            logger.error('API', 'Invalid session code format', { sessionCode });\n            throw error;\n        }\n\n        const timer = logger.startTimer('fetchSessionData');\n        \n        try {\n            const url = `${this.baseURL}/session/${sessionCode}`;\n            logger.info('API', 'Making API request', { \n                url,\n                fullURL: url,\n                baseURL: this.baseURL,\n                sessionCode,\n                environment: process.env.NODE_ENV\n            });\n\n            const response = await Utils.retry(\n                () => this.makeRequest(url),\n                this.retryAttempts,\n                this.retryDelay\n            );\n\n            timer.stop();\n            \n            // Validate response structure\n            this.validateSessionData(response);\n            \n            logger.info('API', 'Session data fetched successfully', {\n                sessionCode,\n                hasConversations: response.conversations?.length > 0,\n                totalConversations: response.conversations?.length || 0\n            });\n\n            return response;\n            \n        } catch (error) {\n            timer.stop();\n            \n            // Enhanced error handling\n            const enhancedError = this.handleApiError(error, sessionCode);\n            logger.error('API', 'Failed to fetch session data', {\n                sessionCode,\n                error: enhancedError.message,\n                status: enhancedError.status,\n                originalError: error.message\n            });\n            \n            throw enhancedError;\n        }\n    }\n\n    // Low-level request method\n    async makeRequest(url, options = {}) {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), this.defaultTimeout);\n\n        const defaultOptions = {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            signal: controller.signal\n        };\n\n        const requestOptions = { ...defaultOptions, ...options };\n        const startTime = performance.now();\n\n        try {\n            logger.debug('API', 'Making HTTP request', { url, method: requestOptions.method });\n\n            const response = await fetch(url, requestOptions);\n            const endTime = performance.now();\n            const duration = endTime - startTime;\n\n            clearTimeout(timeoutId);\n\n            logger.logApiCall(\n                requestOptions.method,\n                url,\n                response.status,\n                duration,\n                requestOptions.body,\n                null // Response data will be logged separately\n            );\n\n            if (!response.ok) {\n                const errorText = await response.text().catch(() => 'Unable to read error response');\n                const error = new Error(`HTTP ${response.status}: ${response.statusText}`);\n                error.status = response.status;\n                error.response = response;\n                error.responseText = errorText;\n                \n                throw error;\n            }\n\n            const contentType = response.headers.get('content-type');\n            if (!contentType || !contentType.includes('application/json')) {\n                logger.warn('API', 'Response is not JSON', { contentType, url });\n            }\n\n            const data = await response.json();\n            \n            logger.debug('API', 'Request successful', {\n                url,\n                status: response.status,\n                duration: `${duration.toFixed(2)}ms`,\n                dataSize: JSON.stringify(data).length + ' bytes'\n            });\n\n            return data;\n\n        } catch (error) {\n            clearTimeout(timeoutId);\n            const endTime = performance.now();\n            const duration = endTime - startTime;\n\n            if (error.name === 'AbortError') {\n                logger.error('API', 'Request timeout', { url, timeout: this.defaultTimeout });\n                const timeoutError = new Error('Request timeout');\n                timeoutError.code = 'TIMEOUT';\n                throw timeoutError;\n            }\n\n            logger.logApiCall(\n                requestOptions.method,\n                url,\n                error.status || 0,\n                duration,\n                requestOptions.body,\n                error.message\n            );\n\n            throw error;\n        }\n    }\n\n    // Validate session data structure\n    validateSessionData(data) {\n        logger.debug('API', 'Validating session data structure');\n\n        if (!data || typeof data !== 'object') {\n            throw new Error('Invalid response: data is not an object');\n        }\n\n        // Required fields validation\n        const requiredFields = ['session_info', 'user_info', 'conversations'];\n        for (const field of requiredFields) {\n            if (!data[field]) {\n                logger.warn('API', `Missing required field: ${field}`);\n            }\n        }\n\n        // Validate session_info\n        if (data.session_info) {\n            const sessionRequiredFields = ['id', 'status'];\n            for (const field of sessionRequiredFields) {\n                if (!data.session_info[field]) {\n                    logger.warn('API', `Missing session_info field: ${field}`);\n                }\n            }\n        }\n\n        // Validate conversations array\n        if (data.conversations && Array.isArray(data.conversations)) {\n            logger.info('API', 'Validating conversations', { count: data.conversations.length });\n            \n            data.conversations.forEach((conv, index) => {\n                if (!conv.question_text) {\n                    logger.warn('API', `Missing question_text in conversation ${index}`);\n                }\n                if (!conv.transcript) {\n                    logger.warn('API', `Missing transcript in conversation ${index}`);\n                }\n                if (!conv.ielts_scores) {\n                    logger.warn('API', `Missing ielts_scores in conversation ${index}`);\n                }\n            });\n        }\n\n        logger.info('API', 'Session data validation completed');\n    }\n\n    // Enhanced error handling\n    handleApiError(error, sessionCode) {\n        let message = 'An error occurred while fetching the results';\n        let code = 'UNKNOWN_ERROR';\n        let status = error.status || 0;\n\n        if (error.name === 'AbortError' || error.code === 'TIMEOUT') {\n            message = 'Request timeout. Please check your internet connection and try again.';\n            code = 'TIMEOUT';\n        } else if (error.status === 404) {\n            message = 'Results not found for this session. Please check the session code.';\n            code = 'NOT_FOUND';\n        } else if (error.status === 400) {\n            message = 'Invalid session code format.';\n            code = 'BAD_REQUEST';\n        } else if (error.status === 403) {\n            message = 'Access denied. You may not have permission to view these results.';\n            code = 'FORBIDDEN';\n        } else if (error.status === 429) {\n            message = 'Too many requests. Please wait a moment and try again.';\n            code = 'RATE_LIMITED';\n        } else if (error.status >= 500) {\n            message = 'Server error. Please try again later.';\n            code = 'SERVER_ERROR';\n        } else if (!navigator.onLine) {\n            message = 'No internet connection. Please check your connection and try again.';\n            code = 'NO_CONNECTION';\n        } else if (error.message.includes('Failed to fetch')) {\n            message = 'Unable to connect to the server. Please try again later.';\n            code = 'NETWORK_ERROR';\n        }\n\n        const enhancedError = new Error(message);\n        enhancedError.code = code;\n        enhancedError.status = status;\n        enhancedError.sessionCode = sessionCode;\n        enhancedError.originalError = error;\n\n        return enhancedError;\n    }\n\n    // Method to get cached session data\n    getCachedSessionData(sessionCode, maxAge = 5 * 60 * 1000) { // 5 minutes default\n        const cached = Utils.getStorage(`session_${sessionCode}`, 'sessionStorage');\n        \n        if (!cached) {\n            logger.debug('API', 'No cached data found', { sessionCode });\n            return null;\n        }\n\n        const isExpired = Date.now() - cached.timestamp > maxAge;\n        if (isExpired) {\n            logger.debug('API', 'Cached data expired', { sessionCode });\n            Utils.removeStorage(`session_${sessionCode}`, 'sessionStorage');\n            return null;\n        }\n\n        logger.info('API', 'Using cached session data', { sessionCode });\n        return cached.data;\n    }\n\n    // Method to cache session data\n    cacheSessionData(sessionCode, data) {\n        Utils.setStorage(`session_${sessionCode}`, {\n            data,\n            timestamp: Date.now()\n        }, 'sessionStorage');\n        \n        logger.info('API', 'Session data cached', { sessionCode });\n    }\n\n    // Method to clear all cached data\n    clearCache() {\n        logger.info('API', 'Clearing API cache');\n        \n        // Clear all session storage items that start with 'session_'\n        for (let i = sessionStorage.length - 1; i >= 0; i--) {\n            const key = sessionStorage.key(i);\n            if (key && key.startsWith('session_')) {\n                sessionStorage.removeItem(key);\n            }\n        }\n        \n        logger.info('API', 'API cache cleared');\n    }\n\n    // Method to check API health\n    async checkApiHealth() {\n        logger.info('API', 'Checking API health');\n        \n        try {\n            const url = `${this.baseURL}/health`;\n            const response = await this.makeRequest(url);\n            \n            logger.info('API', 'API health check successful', response);\n            return true;\n        } catch (error) {\n            logger.error('API', 'API health check failed', { error: error.message });\n            return false;\n        }\n    }\n\n    // Method to get API statistics\n    getApiStats() {\n        const stats = {\n            baseURL: this.baseURL,\n            defaultTimeout: this.defaultTimeout,\n            retryAttempts: this.retryAttempts,\n            retryDelay: this.retryDelay,\n            isOnline: navigator.onLine,\n            userAgent: navigator.userAgent\n        };\n\n        logger.debug('API', 'API statistics', stats);\n        return stats;\n    }\n}\n\n// Create and export API service instance\nexport const apiService = new ApiService();\n\nlogger.info('API', 'API service initialized successfully');"],"mappings":"AAAA,SAASA,MAAM,QAAQ,UAAU;AACjC,SAASC,KAAK,QAAQ,kBAAkB;;AAExC;AACA,MAAMC,UAAU,CAAC;EACbC,WAAWA,CAAA,EAAG;IACV;IACA,IAAI,CAACC,OAAO,GAAGC,OAAO,CAACC,GAAG,CAACC,QAAQ,KAAK,aAAa,GAC/C,EAAE,CAAC;IAAA,EACH,oDAAoD;IAC1D,IAAI,CAACC,cAAc,GAAG,KAAK,CAAC,CAAC;IAC7B,IAAI,CAACC,aAAa,GAAG,CAAC;IACtB,IAAI,CAACC,UAAU,GAAG,IAAI,CAAC,CAAC;;IAExBV,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,wBAAwB,EAAE;MACzCP,OAAO,EAAE,IAAI,CAACA,OAAO,IAAI,aAAa;MACtCQ,WAAW,EAAEP,OAAO,CAACC,GAAG,CAACC;IAC7B,CAAC,CAAC;EACN;;EAEA;EACA,MAAMM,gBAAgBA,CAACC,WAAW,EAAE;IAChCd,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,uBAAuB,EAAE;MAAEG;IAAY,CAAC,CAAC;IAE5D,IAAI,CAACA,WAAW,EAAE;MACd,MAAMC,KAAK,GAAG,IAAIC,KAAK,CAAC,0BAA0B,CAAC;MACnDhB,MAAM,CAACe,KAAK,CAAC,KAAK,EAAE,0BAA0B,CAAC;MAC/C,MAAMA,KAAK;IACf;IAEA,IAAI,CAACd,KAAK,CAACgB,kBAAkB,CAACH,WAAW,CAAC,EAAE;MACxC,MAAMC,KAAK,GAAG,IAAIC,KAAK,CAAC,6BAA6B,CAAC;MACtDhB,MAAM,CAACe,KAAK,CAAC,KAAK,EAAE,6BAA6B,EAAE;QAAED;MAAY,CAAC,CAAC;MACnE,MAAMC,KAAK;IACf;IAEA,MAAMG,KAAK,GAAGlB,MAAM,CAACmB,UAAU,CAAC,kBAAkB,CAAC;IAEnD,IAAI;MAAA,IAAAC,qBAAA,EAAAC,sBAAA;MACA,MAAMC,GAAG,GAAG,GAAG,IAAI,CAAClB,OAAO,YAAYU,WAAW,EAAE;MACpDd,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,oBAAoB,EAAE;QACrCW,GAAG;QACHC,OAAO,EAAED,GAAG;QACZlB,OAAO,EAAE,IAAI,CAACA,OAAO;QACrBU,WAAW;QACXF,WAAW,EAAEP,OAAO,CAACC,GAAG,CAACC;MAC7B,CAAC,CAAC;MAEF,MAAMiB,QAAQ,GAAG,MAAMvB,KAAK,CAACwB,KAAK,CAC9B,MAAM,IAAI,CAACC,WAAW,CAACJ,GAAG,CAAC,EAC3B,IAAI,CAACb,aAAa,EAClB,IAAI,CAACC,UACT,CAAC;MAEDQ,KAAK,CAACS,IAAI,CAAC,CAAC;;MAEZ;MACA,IAAI,CAACC,mBAAmB,CAACJ,QAAQ,CAAC;MAElCxB,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,mCAAmC,EAAE;QACpDG,WAAW;QACXe,gBAAgB,EAAE,EAAAT,qBAAA,GAAAI,QAAQ,CAACM,aAAa,cAAAV,qBAAA,uBAAtBA,qBAAA,CAAwBW,MAAM,IAAG,CAAC;QACpDC,kBAAkB,EAAE,EAAAX,sBAAA,GAAAG,QAAQ,CAACM,aAAa,cAAAT,sBAAA,uBAAtBA,sBAAA,CAAwBU,MAAM,KAAI;MAC1D,CAAC,CAAC;MAEF,OAAOP,QAAQ;IAEnB,CAAC,CAAC,OAAOT,KAAK,EAAE;MACZG,KAAK,CAACS,IAAI,CAAC,CAAC;;MAEZ;MACA,MAAMM,aAAa,GAAG,IAAI,CAACC,cAAc,CAACnB,KAAK,EAAED,WAAW,CAAC;MAC7Dd,MAAM,CAACe,KAAK,CAAC,KAAK,EAAE,8BAA8B,EAAE;QAChDD,WAAW;QACXC,KAAK,EAAEkB,aAAa,CAACE,OAAO;QAC5BC,MAAM,EAAEH,aAAa,CAACG,MAAM;QAC5BC,aAAa,EAAEtB,KAAK,CAACoB;MACzB,CAAC,CAAC;MAEF,MAAMF,aAAa;IACvB;EACJ;;EAEA;EACA,MAAMP,WAAWA,CAACJ,GAAG,EAAEgB,OAAO,GAAG,CAAC,CAAC,EAAE;IACjC,MAAMC,UAAU,GAAG,IAAIC,eAAe,CAAC,CAAC;IACxC,MAAMC,SAAS,GAAGC,UAAU,CAAC,MAAMH,UAAU,CAACI,KAAK,CAAC,CAAC,EAAE,IAAI,CAACnC,cAAc,CAAC;IAE3E,MAAMoC,cAAc,GAAG;MACnBC,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;QACL,cAAc,EAAE,kBAAkB;QAClC,QAAQ,EAAE;MACd,CAAC;MACDC,MAAM,EAAER,UAAU,CAACQ;IACvB,CAAC;IAED,MAAMC,cAAc,GAAG;MAAE,GAAGJ,cAAc;MAAE,GAAGN;IAAQ,CAAC;IACxD,MAAMW,SAAS,GAAGC,WAAW,CAACC,GAAG,CAAC,CAAC;IAEnC,IAAI;MACAnD,MAAM,CAACoD,KAAK,CAAC,KAAK,EAAE,qBAAqB,EAAE;QAAE9B,GAAG;QAAEuB,MAAM,EAAEG,cAAc,CAACH;MAAO,CAAC,CAAC;MAElF,MAAMrB,QAAQ,GAAG,MAAM6B,KAAK,CAAC/B,GAAG,EAAE0B,cAAc,CAAC;MACjD,MAAMM,OAAO,GAAGJ,WAAW,CAACC,GAAG,CAAC,CAAC;MACjC,MAAMI,QAAQ,GAAGD,OAAO,GAAGL,SAAS;MAEpCO,YAAY,CAACf,SAAS,CAAC;MAEvBzC,MAAM,CAACyD,UAAU,CACbT,cAAc,CAACH,MAAM,EACrBvB,GAAG,EACHE,QAAQ,CAACY,MAAM,EACfmB,QAAQ,EACRP,cAAc,CAACU,IAAI,EACnB,IAAI,CAAC;MACT,CAAC;MAED,IAAI,CAAClC,QAAQ,CAACmC,EAAE,EAAE;QACd,MAAMC,SAAS,GAAG,MAAMpC,QAAQ,CAACqC,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,+BAA+B,CAAC;QACpF,MAAM/C,KAAK,GAAG,IAAIC,KAAK,CAAC,QAAQQ,QAAQ,CAACY,MAAM,KAAKZ,QAAQ,CAACuC,UAAU,EAAE,CAAC;QAC1EhD,KAAK,CAACqB,MAAM,GAAGZ,QAAQ,CAACY,MAAM;QAC9BrB,KAAK,CAACS,QAAQ,GAAGA,QAAQ;QACzBT,KAAK,CAACiD,YAAY,GAAGJ,SAAS;QAE9B,MAAM7C,KAAK;MACf;MAEA,MAAMkD,WAAW,GAAGzC,QAAQ,CAACsB,OAAO,CAACoB,GAAG,CAAC,cAAc,CAAC;MACxD,IAAI,CAACD,WAAW,IAAI,CAACA,WAAW,CAACE,QAAQ,CAAC,kBAAkB,CAAC,EAAE;QAC3DnE,MAAM,CAACoE,IAAI,CAAC,KAAK,EAAE,sBAAsB,EAAE;UAAEH,WAAW;UAAE3C;QAAI,CAAC,CAAC;MACpE;MAEA,MAAM+C,IAAI,GAAG,MAAM7C,QAAQ,CAAC8C,IAAI,CAAC,CAAC;MAElCtE,MAAM,CAACoD,KAAK,CAAC,KAAK,EAAE,oBAAoB,EAAE;QACtC9B,GAAG;QACHc,MAAM,EAAEZ,QAAQ,CAACY,MAAM;QACvBmB,QAAQ,EAAE,GAAGA,QAAQ,CAACgB,OAAO,CAAC,CAAC,CAAC,IAAI;QACpCC,QAAQ,EAAEC,IAAI,CAACC,SAAS,CAACL,IAAI,CAAC,CAACtC,MAAM,GAAG;MAC5C,CAAC,CAAC;MAEF,OAAOsC,IAAI;IAEf,CAAC,CAAC,OAAOtD,KAAK,EAAE;MACZyC,YAAY,CAACf,SAAS,CAAC;MACvB,MAAMa,OAAO,GAAGJ,WAAW,CAACC,GAAG,CAAC,CAAC;MACjC,MAAMI,QAAQ,GAAGD,OAAO,GAAGL,SAAS;MAEpC,IAAIlC,KAAK,CAAC4D,IAAI,KAAK,YAAY,EAAE;QAC7B3E,MAAM,CAACe,KAAK,CAAC,KAAK,EAAE,iBAAiB,EAAE;UAAEO,GAAG;UAAEsD,OAAO,EAAE,IAAI,CAACpE;QAAe,CAAC,CAAC;QAC7E,MAAMqE,YAAY,GAAG,IAAI7D,KAAK,CAAC,iBAAiB,CAAC;QACjD6D,YAAY,CAACC,IAAI,GAAG,SAAS;QAC7B,MAAMD,YAAY;MACtB;MAEA7E,MAAM,CAACyD,UAAU,CACbT,cAAc,CAACH,MAAM,EACrBvB,GAAG,EACHP,KAAK,CAACqB,MAAM,IAAI,CAAC,EACjBmB,QAAQ,EACRP,cAAc,CAACU,IAAI,EACnB3C,KAAK,CAACoB,OACV,CAAC;MAED,MAAMpB,KAAK;IACf;EACJ;;EAEA;EACAa,mBAAmBA,CAACyC,IAAI,EAAE;IACtBrE,MAAM,CAACoD,KAAK,CAAC,KAAK,EAAE,mCAAmC,CAAC;IAExD,IAAI,CAACiB,IAAI,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;MACnC,MAAM,IAAIrD,KAAK,CAAC,yCAAyC,CAAC;IAC9D;;IAEA;IACA,MAAM+D,cAAc,GAAG,CAAC,cAAc,EAAE,WAAW,EAAE,eAAe,CAAC;IACrE,KAAK,MAAMC,KAAK,IAAID,cAAc,EAAE;MAChC,IAAI,CAACV,IAAI,CAACW,KAAK,CAAC,EAAE;QACdhF,MAAM,CAACoE,IAAI,CAAC,KAAK,EAAE,2BAA2BY,KAAK,EAAE,CAAC;MAC1D;IACJ;;IAEA;IACA,IAAIX,IAAI,CAACY,YAAY,EAAE;MACnB,MAAMC,qBAAqB,GAAG,CAAC,IAAI,EAAE,QAAQ,CAAC;MAC9C,KAAK,MAAMF,KAAK,IAAIE,qBAAqB,EAAE;QACvC,IAAI,CAACb,IAAI,CAACY,YAAY,CAACD,KAAK,CAAC,EAAE;UAC3BhF,MAAM,CAACoE,IAAI,CAAC,KAAK,EAAE,+BAA+BY,KAAK,EAAE,CAAC;QAC9D;MACJ;IACJ;;IAEA;IACA,IAAIX,IAAI,CAACvC,aAAa,IAAIqD,KAAK,CAACC,OAAO,CAACf,IAAI,CAACvC,aAAa,CAAC,EAAE;MACzD9B,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,0BAA0B,EAAE;QAAE0E,KAAK,EAAEhB,IAAI,CAACvC,aAAa,CAACC;MAAO,CAAC,CAAC;MAEpFsC,IAAI,CAACvC,aAAa,CAACwD,OAAO,CAAC,CAACC,IAAI,EAAEC,KAAK,KAAK;QACxC,IAAI,CAACD,IAAI,CAACE,aAAa,EAAE;UACrBzF,MAAM,CAACoE,IAAI,CAAC,KAAK,EAAE,yCAAyCoB,KAAK,EAAE,CAAC;QACxE;QACA,IAAI,CAACD,IAAI,CAACG,UAAU,EAAE;UAClB1F,MAAM,CAACoE,IAAI,CAAC,KAAK,EAAE,sCAAsCoB,KAAK,EAAE,CAAC;QACrE;QACA,IAAI,CAACD,IAAI,CAACI,YAAY,EAAE;UACpB3F,MAAM,CAACoE,IAAI,CAAC,KAAK,EAAE,wCAAwCoB,KAAK,EAAE,CAAC;QACvE;MACJ,CAAC,CAAC;IACN;IAEAxF,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,mCAAmC,CAAC;EAC3D;;EAEA;EACAuB,cAAcA,CAACnB,KAAK,EAAED,WAAW,EAAE;IAC/B,IAAIqB,OAAO,GAAG,8CAA8C;IAC5D,IAAI2C,IAAI,GAAG,eAAe;IAC1B,IAAI1C,MAAM,GAAGrB,KAAK,CAACqB,MAAM,IAAI,CAAC;IAE9B,IAAIrB,KAAK,CAAC4D,IAAI,KAAK,YAAY,IAAI5D,KAAK,CAAC+D,IAAI,KAAK,SAAS,EAAE;MACzD3C,OAAO,GAAG,uEAAuE;MACjF2C,IAAI,GAAG,SAAS;IACpB,CAAC,MAAM,IAAI/D,KAAK,CAACqB,MAAM,KAAK,GAAG,EAAE;MAC7BD,OAAO,GAAG,oEAAoE;MAC9E2C,IAAI,GAAG,WAAW;IACtB,CAAC,MAAM,IAAI/D,KAAK,CAACqB,MAAM,KAAK,GAAG,EAAE;MAC7BD,OAAO,GAAG,8BAA8B;MACxC2C,IAAI,GAAG,aAAa;IACxB,CAAC,MAAM,IAAI/D,KAAK,CAACqB,MAAM,KAAK,GAAG,EAAE;MAC7BD,OAAO,GAAG,mEAAmE;MAC7E2C,IAAI,GAAG,WAAW;IACtB,CAAC,MAAM,IAAI/D,KAAK,CAACqB,MAAM,KAAK,GAAG,EAAE;MAC7BD,OAAO,GAAG,wDAAwD;MAClE2C,IAAI,GAAG,cAAc;IACzB,CAAC,MAAM,IAAI/D,KAAK,CAACqB,MAAM,IAAI,GAAG,EAAE;MAC5BD,OAAO,GAAG,uCAAuC;MACjD2C,IAAI,GAAG,cAAc;IACzB,CAAC,MAAM,IAAI,CAACc,SAAS,CAACC,MAAM,EAAE;MAC1B1D,OAAO,GAAG,qEAAqE;MAC/E2C,IAAI,GAAG,eAAe;IAC1B,CAAC,MAAM,IAAI/D,KAAK,CAACoB,OAAO,CAACgC,QAAQ,CAAC,iBAAiB,CAAC,EAAE;MAClDhC,OAAO,GAAG,0DAA0D;MACpE2C,IAAI,GAAG,eAAe;IAC1B;IAEA,MAAM7C,aAAa,GAAG,IAAIjB,KAAK,CAACmB,OAAO,CAAC;IACxCF,aAAa,CAAC6C,IAAI,GAAGA,IAAI;IACzB7C,aAAa,CAACG,MAAM,GAAGA,MAAM;IAC7BH,aAAa,CAACnB,WAAW,GAAGA,WAAW;IACvCmB,aAAa,CAACI,aAAa,GAAGtB,KAAK;IAEnC,OAAOkB,aAAa;EACxB;;EAEA;EACA6D,oBAAoBA,CAAChF,WAAW,EAAEiF,MAAM,GAAG,CAAC,GAAG,EAAE,GAAG,IAAI,EAAE;IAAE;IACxD,MAAMC,MAAM,GAAG/F,KAAK,CAACgG,UAAU,CAAC,WAAWnF,WAAW,EAAE,EAAE,gBAAgB,CAAC;IAE3E,IAAI,CAACkF,MAAM,EAAE;MACThG,MAAM,CAACoD,KAAK,CAAC,KAAK,EAAE,sBAAsB,EAAE;QAAEtC;MAAY,CAAC,CAAC;MAC5D,OAAO,IAAI;IACf;IAEA,MAAMoF,SAAS,GAAGC,IAAI,CAAChD,GAAG,CAAC,CAAC,GAAG6C,MAAM,CAACI,SAAS,GAAGL,MAAM;IACxD,IAAIG,SAAS,EAAE;MACXlG,MAAM,CAACoD,KAAK,CAAC,KAAK,EAAE,qBAAqB,EAAE;QAAEtC;MAAY,CAAC,CAAC;MAC3Db,KAAK,CAACoG,aAAa,CAAC,WAAWvF,WAAW,EAAE,EAAE,gBAAgB,CAAC;MAC/D,OAAO,IAAI;IACf;IAEAd,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,2BAA2B,EAAE;MAAEG;IAAY,CAAC,CAAC;IAChE,OAAOkF,MAAM,CAAC3B,IAAI;EACtB;;EAEA;EACAiC,gBAAgBA,CAACxF,WAAW,EAAEuD,IAAI,EAAE;IAChCpE,KAAK,CAACsG,UAAU,CAAC,WAAWzF,WAAW,EAAE,EAAE;MACvCuD,IAAI;MACJ+B,SAAS,EAAED,IAAI,CAAChD,GAAG,CAAC;IACxB,CAAC,EAAE,gBAAgB,CAAC;IAEpBnD,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,qBAAqB,EAAE;MAAEG;IAAY,CAAC,CAAC;EAC9D;;EAEA;EACA0F,UAAUA,CAAA,EAAG;IACTxG,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,oBAAoB,CAAC;;IAExC;IACA,KAAK,IAAI8F,CAAC,GAAGC,cAAc,CAAC3E,MAAM,GAAG,CAAC,EAAE0E,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE;MACjD,MAAME,GAAG,GAAGD,cAAc,CAACC,GAAG,CAACF,CAAC,CAAC;MACjC,IAAIE,GAAG,IAAIA,GAAG,CAACC,UAAU,CAAC,UAAU,CAAC,EAAE;QACnCF,cAAc,CAACG,UAAU,CAACF,GAAG,CAAC;MAClC;IACJ;IAEA3G,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,mBAAmB,CAAC;EAC3C;;EAEA;EACA,MAAMmG,cAAcA,CAAA,EAAG;IACnB9G,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,qBAAqB,CAAC;IAEzC,IAAI;MACA,MAAMW,GAAG,GAAG,GAAG,IAAI,CAAClB,OAAO,SAAS;MACpC,MAAMoB,QAAQ,GAAG,MAAM,IAAI,CAACE,WAAW,CAACJ,GAAG,CAAC;MAE5CtB,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,6BAA6B,EAAEa,QAAQ,CAAC;MAC3D,OAAO,IAAI;IACf,CAAC,CAAC,OAAOT,KAAK,EAAE;MACZf,MAAM,CAACe,KAAK,CAAC,KAAK,EAAE,yBAAyB,EAAE;QAAEA,KAAK,EAAEA,KAAK,CAACoB;MAAQ,CAAC,CAAC;MACxE,OAAO,KAAK;IAChB;EACJ;;EAEA;EACA4E,WAAWA,CAAA,EAAG;IACV,MAAMC,KAAK,GAAG;MACV5G,OAAO,EAAE,IAAI,CAACA,OAAO;MACrBI,cAAc,EAAE,IAAI,CAACA,cAAc;MACnCC,aAAa,EAAE,IAAI,CAACA,aAAa;MACjCC,UAAU,EAAE,IAAI,CAACA,UAAU;MAC3BuG,QAAQ,EAAErB,SAAS,CAACC,MAAM;MAC1BqB,SAAS,EAAEtB,SAAS,CAACsB;IACzB,CAAC;IAEDlH,MAAM,CAACoD,KAAK,CAAC,KAAK,EAAE,gBAAgB,EAAE4D,KAAK,CAAC;IAC5C,OAAOA,KAAK;EAChB;AACJ;;AAEA;AACA,OAAO,MAAMG,UAAU,GAAG,IAAIjH,UAAU,CAAC,CAAC;AAE1CF,MAAM,CAACW,IAAI,CAAC,KAAK,EAAE,sCAAsC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}